#include <iostream>
#include <string>
using namespace std;

const int MAX_SIZE = 5;

struct Ticket {
    int ticketNumber;
    string customerName;
    string issueDescription;
};

// Circular queue variables
Ticket queue[MAX_SIZE];
int front = -1, rear = -1, size = 0;
int ticketCounter = 1;

bool isEmpty() {
    return size == 0;
}

bool isFull() {
    return size == MAX_SIZE;
}

void submitTicket() {
    if (isFull()) {
        cout << "Queue is full. Cannot add more tickets.\n";
        return;
    }
    Ticket t;
    t.ticketNumber = ticketCounter++;
    cout << "Enter customer name: ";
    getline(cin, t.customerName);
    cout << "Enter issue description: ";
    getline(cin, t.issueDescription);
    
    if (isEmpty()) {
        front = rear = 0;
    } else {
        rear = (rear + 1) % MAX_SIZE;
    }
    queue[rear] = t;
    size++;
    cout << "Ticket submitted successfully. Ticket Number: " << t.ticketNumber << endl;
}

void resolveTicket() {
    if (isEmpty()) {
        cout << "No tickets to resolve.\n";
        return;
    }
    Ticket t = queue[front];
    cout << "Resolving Ticket #" << t.ticketNumber << "\n"
         << "Customer: " << t.customerName << "\n"
         << "Issue: " << t.issueDescription << endl;
    front = (front + 1) % MAX_SIZE;
    size--;
    if (size == 0) {
        front = rear = -1;
    }
}

void checkNextTicket() {
    if (isEmpty()) {
        cout << "No tickets to show.\n";
        return;
    }
    Ticket t = queue[front];
    cout << "Next Ticket #" << t.ticketNumber << "\n"
         << "Customer: " << t.customerName << "\n"
         << "Issue: " << t.issueDescription << endl;
}

void displayStatus() {
    cout << "Open tickets in queue: " << size << endl;
    cout << (isEmpty() ? "The queue is empty.\n" : "The queue is not empty.\n");
}

int main() {
    int choice;
    string dummy;
    do {
        cout << "\nCustomer Support System - Circular Queue\n";
        cout << "1. Submit Ticket (Enqueue)\n";
        cout << "2. Resolve Ticket (Dequeue)\n";
        cout << "3. Check Next Ticket (Peek)\n";
        cout << "4. Display Queue Status (Size/Empty)\n";
        cout << "5. Exit\n";
        cout << "Enter your choice: ";
        cin >> choice;
        getline(cin, dummy); // To clear the buffer

        switch (choice) {
        case 1:
            submitTicket();
            break;
        case 2:
            resolveTicket();
            break;
        case 3:
            checkNextTicket();
            break;
        case 4:
            displayStatus();
            break;
        case 5:
            cout << "Exiting...\n";
            break;
        default:
            cout << "Invalid choice, try again.\n";
        }
    } while (choice != 5);

    return 0;
}
